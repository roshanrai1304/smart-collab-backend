# Smart Collaborative Backend

A real-time collaborative document platform with AI-powered features including summarization, auto-tagging, and knowledge base Q&A.

## 🏗️ Architecture

This project follows a microservices architecture with:
- **Django Backend** with REST API and WebSocket support
- **PostgreSQL** with pgvector for embeddings
- **Redis** for caching and real-time features
- **Celery** for background tasks
- **AI Services** for document processing

See [ARCHITECTURE.md](ARCHITECTURE.md) for detailed system design.

## 🚀 Quick Start

### Prerequisites

Make sure you have completed the initial setup from [SETUP.md](SETUP.md):
- PostgreSQL 16 with pgvector extension
- Redis server
- Python with UV package manager

### 1. Complete pgvector Installation

```bash
cd /tmp/pgvector
make
sudo make install
```

### 2. Set up Database

```bash
# Connect to PostgreSQL
psql postgres

# Create database and user
CREATE DATABASE smart_collab_db;
CREATE USER smart_collab_user WITH PASSWORD 'your_secure_password';
GRANT ALL PRIVILEGES ON DATABASE smart_collab_db TO smart_collab_user;
ALTER USER smart_collab_user CREATEDB;

# Enable extensions
\c smart_collab_db
CREATE EXTENSION IF NOT EXISTS vector;
CREATE EXTENSION IF NOT EXISTS pg_trgm;
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

\q
```

### 3. Configure Environment

```bash
# Copy environment template
cp .env.example .env

# Edit .env with your settings
# - Update DB_PASSWORD with your database password
# - Generate SECRET_KEY (see step 4)
# - Add OPENAI_API_KEY if you have one
```

### 4. Run Django Setup

```bash
# Make setup script executable (if not already)
chmod +x setup_django.sh

# Run the complete Django setup
./setup_django.sh
```

This script will:
- Create virtual environment
- Install all dependencies
- Initialize Django project
- Create all apps and configurations
- Test the setup

### 5. Generate Secret Key

```bash
# Generate a secure secret key
python -c "from django.core.management.utils import get_random_secret_key; print('SECRET_KEY=' + get_random_secret_key())"

# Copy the output and update your .env file
```

### 6. Initialize Database

```bash
# Create and apply migrations
python manage.py makemigrations
python manage.py migrate

# Create superuser account
python manage.py createsuperuser
```

### 7. Start Development Server

```bash
# Start Django development server
python manage.py runserver

# In another terminal, start Celery worker (optional)
celery -A config worker --loglevel=info
```

## 🔗 API Endpoints

Once running, access these URLs:

- **API Documentation**: http://127.0.0.1:8000/api/docs/
- **API Schema**: http://127.0.0.1:8000/api/redoc/
- **Django Admin**: http://127.0.0.1:8000/admin/

## 📁 Project Structure

```
smart-collab-backend/
├── ARCHITECTURE.md          # System architecture documentation
├── SETUP.md                # Detailed setup instructions
├── README.md               # This file
├── requirements.in         # Python dependencies
├── setup_django.sh        # Django setup script
├── .env.example           # Environment variables template
├── .gitignore             # Git ignore rules
│
# Generated by setup_django.sh:
├── manage.py              # Django management script
├── celery_app.py         # Celery configuration
├── config/               # Django project settings
│   ├── settings/         # Environment-specific settings
│   ├── urls.py          # URL routing
│   ├── wsgi.py          # WSGI application
│   └── asgi.py          # ASGI application (WebSockets)
│
├── apps/                 # Django applications
│   ├── authentication/  # User auth & JWT
│   ├── organizations/   # Teams & organizations
│   ├── documents/       # Document management
│   ├── collaboration/   # Real-time collaboration
│   ├── ai_services/     # AI integration
│   ├── notifications/   # Notification system
│   ├── files/          # File management
│   └── core/           # Shared utilities
│
├── static/             # Static files
├── media/              # Uploaded files
├── templates/          # Django templates
└── logs/               # Application logs
```

## 🛠️ Development

### Running Tests

```bash
# Run all tests
python manage.py test

# Run specific app tests
python manage.py test apps.authentication
```

### Database Operations

```bash
# Create new migration
python manage.py makemigrations app_name

# Apply migrations
python manage.py migrate

# Reset database (development only)
python manage.py flush
```

### Background Tasks

```bash
# Start Celery worker
celery -A config worker --loglevel=info

# Start Celery beat (for scheduled tasks)
celery -A config beat --loglevel=info
```

## 🔄 Next Steps

After basic setup, you can:

1. **Implement Models** - Create Django models based on the architecture
2. **Build API Endpoints** - Create DRF serializers and viewsets
3. **Add Authentication** - Implement JWT and OAuth2
4. **WebSocket Features** - Real-time collaboration consumers
5. **AI Integration** - Document processing and embeddings
6. **Frontend Integration** - Connect with React frontend

## 📚 Documentation

- [ARCHITECTURE.md](ARCHITECTURE.md) - Complete system architecture
- [SETUP.md](SETUP.md) - Detailed setup instructions
- API Documentation: Available at `/api/docs/` when running

## 🤝 Contributing

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Run tests
5. Submit a pull request

## 📄 License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.
